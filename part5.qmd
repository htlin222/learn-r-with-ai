# ç¬¬äº”éƒ¨åˆ†ï¼šçµ±è¨ˆæª¢å®š

æœ¬éƒ¨åˆ†é è¨ˆæ™‚é–“ï¼š30 åˆ†é˜

## ä»»å‹™ 20ï¼šè®“ AI é¸æ“‡çµ±è¨ˆæ–¹æ³•

ğŸ“‹ **è¤‡è£½é€™æ®µè©±ï¼Œè²¼çµ¦ AIï¼š**

> æˆ‘æƒ³è¦æ¯”è¼ƒå…©çµ„ç—…äººï¼ˆtreatment A vs Bï¼‰çš„ä½é™¢å¤©æ•¸ï¼ˆlosï¼‰æœ‰æ²’æœ‰é¡¯è‘—å·®ç•°ã€‚æˆ‘çš„è³‡æ–™å­˜åœ¨ `my_data` è£¡é¢ã€‚
> 
> è«‹å¹«æˆ‘ï¼š
> 
> 1. åˆ¤æ–·æ‡‰è©²ç”¨ä»€éº¼çµ±è¨ˆæ–¹æ³•ï¼ˆç‚ºä»€éº¼ï¼‰
> 2. çµ¦æˆ‘åŸ·è¡Œé€™å€‹æª¢å®šçš„ R ç¨‹å¼ç¢¼
> 3. å‘Šè¨´æˆ‘æ€éº¼è§£è®€çµæœ

### çµ±è¨ˆæª¢å®šé¸æ“‡

```{r}
#| label: statistical-test
#| echo: true
#| message: false
#| warning: false

# è®€å–è³‡æ–™
my_data <- read.csv("patient_data.csv")

# å…ˆæª¢æŸ¥è³‡æ–™åˆ†ä½ˆ
library(ggplot2)

# æª¢è¦–åˆ†ä½ˆåœ–
ggplot(my_data, aes(x = los, fill = treatment)) +
  geom_histogram(binwidth = 1, alpha = 0.6, position = "dodge") +
  facet_wrap(~treatment, ncol = 1) +
  theme_minimal()

# å¸¸æ…‹æ€§æª¢å®š
shapiro_a <- shapiro.test(my_data$los[my_data$treatment == "A"])
shapiro_b <- shapiro.test(my_data$los[my_data$treatment == "B"])

print("Shapiro-Wilk å¸¸æ…‹æ€§æª¢å®šçµæœï¼š")
print(paste("A çµ„ p-value:", round(shapiro_a$p.value, 4)))
print(paste("B çµ„ p-value:", round(shapiro_b$p.value, 4)))
```

### åŸ·è¡Œçµ±è¨ˆæª¢å®š

```{r}
#| label: t-test
#| echo: true

# åŸ·è¡Œ t-testï¼ˆå‡è¨­è³‡æ–™ç¬¦åˆå¸¸æ…‹åˆ†ä½ˆï¼‰
t_test_result <- t.test(los ~ treatment, data = my_data)
print(t_test_result)

# åŸ·è¡Œ Wilcoxon rank-sum testï¼ˆç„¡æ¯æ•¸æª¢å®šï¼‰
wilcox_result <- wilcox.test(los ~ treatment, data = my_data)
print(wilcox_result)
```

## ä»»å‹™ 21ï¼šè§£è®€ä½ çš„çµæœ

ğŸ“‹ **æŠŠçµ±è¨ˆæª¢å®šçš„è¼¸å‡ºè¤‡è£½èµ·ä¾†ï¼ŒåŠ ä¸Šé€™æ®µè©±è²¼çµ¦ AIï¼š**

> é€™æ˜¯æˆ‘çš„çµ±è¨ˆæª¢å®šçµæœï¼š
> ã€è²¼ä¸Šè¼¸å‡ºã€‘
> 
> è«‹ç”¨ç™½è©±æ–‡è§£é‡‹é€™å€‹çµæœï¼ŒåŒ…æ‹¬ï¼š
> 
> 1. å…©çµ„æœ‰æ²’æœ‰é¡¯è‘—å·®ç•°
> 2. p-value æ˜¯ä»€éº¼æ„æ€
> 3. é€™å€‹çµæœåœ¨è‡¨åºŠä¸Šå¯èƒ½ä»£è¡¨ä»€éº¼

### çµæœè§£è®€

```{r}
#| label: interpret-results
#| echo: true

# æ•´ç†çµæœæ‘˜è¦
library(dplyr)

result_summary <- my_data %>%
  group_by(treatment) %>%
  summarise(
    n = n(),
    mean_los = mean(los),
    sd_los = sd(los),
    median_los = median(los),
    min_los = min(los),
    max_los = max(los)
  )

print("å„çµ„æè¿°æ€§çµ±è¨ˆï¼š")
print(result_summary)

# è¨ˆç®—æ•ˆæ‡‰é‡ï¼ˆCohen's dï¼‰
if (!require(effsize, quietly = TRUE)) {
  install.packages("effsize", repos = "https://cloud.r-project.org/")
  library(effsize)
}
cohen_d <- cohen.d(los ~ treatment, data = my_data)
print(paste("æ•ˆæ‡‰é‡ (Cohen's d):", round(cohen_d$estimate, 3)))

# è§£é‡‹
if (t_test_result$p.value < 0.05) {
  print("çµè«–ï¼šå…©çµ„åœ¨çµ±è¨ˆä¸Šæœ‰é¡¯è‘—å·®ç•° (p < 0.05)")
  print(paste("B çµ„çš„å¹³å‡ä½é™¢å¤©æ•¸æ¯” A çµ„å¤šç´„", 
              round(diff(result_summary$mean_los), 1), "å¤©"))
} else {
  print("çµè«–ï¼šå…©çµ„åœ¨çµ±è¨ˆä¸Šç„¡é¡¯è‘—å·®ç•° (p >= 0.05)")
}
```

## ä»»å‹™ 22ï¼šæª¢æŸ¥å‡è¨­

ğŸ“‹ **è¤‡è£½é€™æ®µè©±ï¼Œè²¼çµ¦ AIï¼š**

> å‰›å‰›çš„çµ±è¨ˆæª¢å®šæœ‰ä»€éº¼å‰æå‡è¨­ï¼Ÿæˆ‘è¦æ€éº¼ç”¨ R æª¢æŸ¥æˆ‘çš„è³‡æ–™æœ‰æ²’æœ‰ç¬¦åˆé€™äº›å‡è¨­ï¼Ÿå¦‚æœä¸ç¬¦åˆï¼Œæœ‰ä»€éº¼æ›¿ä»£æ–¹æ³•ï¼Ÿ

### å‡è¨­æª¢é©—

```{r}
#| label: check-assumptions
#| echo: true
#| message: false
#| warning: false

# 1. æª¢æŸ¥å¸¸æ…‹æ€§
if (!require(car, quietly = TRUE)) {
  install.packages("car", repos = "https://cloud.r-project.org/")
  library(car)
}

# Q-Q plot
par(mfrow = c(1, 2))
qqnorm(my_data$los[my_data$treatment == "A"], main = "Q-Q Plot: Treatment A")
qqline(my_data$los[my_data$treatment == "A"])

qqnorm(my_data$los[my_data$treatment == "B"], main = "Q-Q Plot: Treatment B")
qqline(my_data$los[my_data$treatment == "B"])

# 2. æª¢æŸ¥è®Šç•°æ•¸åŒè³ªæ€§
levene_result <- leveneTest(los ~ treatment, data = my_data)
print("Levene's Test for Homogeneity of Variance:")
print(levene_result)

# 3. æ ¹æ“šå‡è¨­æª¢é©—çµæœé¸æ“‡é©ç•¶æ–¹æ³•
if (shapiro_a$p.value < 0.05 | shapiro_b$p.value < 0.05) {
  print("å»ºè­°ï¼šè³‡æ–™ä¸ç¬¦åˆå¸¸æ…‹åˆ†ä½ˆï¼Œæ‡‰ä½¿ç”¨ Wilcoxon rank-sum test")
} else if (levene_result$`Pr(>F)`[1] < 0.05) {
  print("å»ºè­°ï¼šè®Šç•°æ•¸ä¸åŒè³ªï¼Œæ‡‰ä½¿ç”¨ Welch's t-test")
  welch_result <- t.test(los ~ treatment, data = my_data, var.equal = FALSE)
  print(welch_result)
} else {
  print("å»ºè­°ï¼šè³‡æ–™ç¬¦åˆæ‰€æœ‰å‡è¨­ï¼Œå¯ä½¿ç”¨ Student's t-test")
}
```

## ä»»å‹™ 23ï¼šé¡åˆ¥è®Šæ•¸çš„æ¯”è¼ƒ

ğŸ“‹ **è¤‡è£½é€™æ®µè©±ï¼Œè²¼çµ¦ AIï¼š**

> æˆ‘æƒ³è¦çœ‹ treatmentï¼ˆA vs Bï¼‰å’Œ genderï¼ˆM vs Fï¼‰æœ‰æ²’æœ‰é—œè¯ã€‚ä¹Ÿå°±æ˜¯èªªï¼ŒA çµ„å’Œ B çµ„çš„ç”·å¥³æ¯”ä¾‹æœ‰æ²’æœ‰ä¸åŒã€‚
> 
> è«‹çµ¦æˆ‘é©ç•¶çš„çµ±è¨ˆæª¢å®šç¨‹å¼ç¢¼ï¼Œä¸¦æ•™æˆ‘æ€éº¼è§£è®€ã€‚

### é¡åˆ¥è®Šæ•¸æª¢å®š

```{r}
#| label: categorical-test
#| echo: true

# å»ºç«‹åˆ—è¯è¡¨
contingency_table <- table(my_data$treatment, my_data$gender)
print("åˆ—è¯è¡¨ï¼š")
print(contingency_table)

# åŠ ä¸Šæ¯”ä¾‹
prop_table <- prop.table(contingency_table, margin = 1) * 100
print("å„çµ„æ€§åˆ¥æ¯”ä¾‹ï¼ˆ%ï¼‰ï¼š")
print(round(prop_table, 1))

# åŸ·è¡Œå¡æ–¹æª¢å®š
chisq_result <- chisq.test(contingency_table)
print("å¡æ–¹æª¢å®šçµæœï¼š")
print(chisq_result)

# Fisher's exact testï¼ˆé©ç”¨æ–¼å°æ¨£æœ¬ï¼‰
fisher_result <- fisher.test(contingency_table)
print("Fisher's exact testï¼š")
print(fisher_result)

# è§£è®€çµæœ
if (chisq_result$p.value < 0.05) {
  print("çµè«–ï¼šå…©çµ„çš„æ€§åˆ¥åˆ†ä½ˆæœ‰é¡¯è‘—å·®ç•°")
} else {
  print("çµè«–ï¼šå…©çµ„çš„æ€§åˆ¥åˆ†ä½ˆç„¡é¡¯è‘—å·®ç•°")
}
```