# ç¬¬ä¸‰éƒ¨åˆ†ï¼šç”¢å‡ºä½ çš„ Table 1

æœ¬éƒ¨åˆ†é è¨ˆæ™‚é–“ï¼š40 åˆ†é˜

## ä»»å‹™ 9ï¼šTable 1 æ˜¯ä»€éº¼ï¼Ÿ

ğŸ“‹ **è¤‡è£½é€™æ®µè©±ï¼Œè²¼çµ¦ AIï¼š**

> åœ¨é†«å­¸è«–æ–‡è£¡é¢ï¼ŒTable 1 é€šå¸¸æ˜¯ä»€éº¼ï¼Ÿå®ƒçš„ç›®çš„æ˜¯ä»€éº¼ï¼Ÿè£¡é¢é€šå¸¸æœƒæ”¾å“ªäº›æ±è¥¿ï¼Ÿ

### Table 1 èªªæ˜

åœ¨é†«å­¸è«–æ–‡ä¸­ï¼ŒTable 1 é€šå¸¸æ˜¯ã€ŒåŸºç·šç‰¹å¾µè¡¨ã€ï¼ˆBaseline Characteristics Tableï¼‰ï¼Œç”¨ä¾†ï¼š

1. å±•ç¤ºç ”ç©¶å°è±¡çš„åŸºæœ¬ç‰¹å¾µ
2. æ¯”è¼ƒä¸åŒçµ„åˆ¥çš„åŸºç·šè³‡æ–™
3. è®“è®€è€…åˆ¤æ–·çµ„åˆ¥æ˜¯å¦å¹³è¡¡
4. æä¾›ç ”ç©¶æ—ç¾¤çš„æ•´é«”æ¦‚æ³

## ä»»å‹™ 10ï¼šä½ çš„ç¬¬ä¸€å€‹ Table 1

ğŸ“‹ **è¤‡è£½é€™æ®µè©±ï¼Œè²¼çµ¦ AIï¼š**

> æˆ‘æœ‰ä¸€å€‹ R è³‡æ–™æ¡†å«åš `my_data`ï¼Œè£¡é¢æœ‰é€™äº›æ¬„ä½ï¼š
> 
> - treatmentï¼šæ²»ç™‚çµ„åˆ¥ï¼ˆA æˆ– Bï¼‰
> - ageï¼šå¹´é½¡
> - genderï¼šæ€§åˆ¥ï¼ˆM æˆ– Fï¼‰
> - losï¼šä½é™¢å¤©æ•¸
> 
> è«‹ç”¨ gtsummary å¥—ä»¶å¹«æˆ‘åšä¸€å€‹ Table 1ï¼Œä¾ç…§ treatment åˆ†çµ„ï¼Œé¡¯ç¤ºå…¶ä»–è®Šæ•¸çš„æè¿°æ€§çµ±è¨ˆã€‚è«‹çµ¦æˆ‘å¯ä»¥ç›´æ¥åŸ·è¡Œçš„ç¨‹å¼ç¢¼ã€‚

### å»ºç«‹ Table 1

```{r}
#| label: table1-basic
#| echo: true
#| message: false
#| warning: false

library(gtsummary)
library(dplyr)

# è®€å–è³‡æ–™
my_data <- read.csv("patient_data.csv")

# å»ºç«‹åŸºæœ¬çš„ Table 1
table1 <- my_data %>%
  select(treatment, age, gender, los) %>%
  tbl_summary(
    by = treatment,
    statistic = list(
      all_continuous() ~ "{mean} ({sd})",
      all_categorical() ~ "{n} ({p}%)"
    )
  )

table1
```

## ä»»å‹™ 11ï¼šåŠ ä¸Šçµ±è¨ˆæª¢å®š

ğŸ“‹ **è¤‡è£½é€™æ®µè©±ï¼Œè²¼çµ¦ AIï¼š**

> å‰›å‰›çš„ Table 1 å¾ˆæ£’ã€‚è«‹å¹«æˆ‘åŠ ä¸Š p-valueï¼Œè®“æˆ‘å¯ä»¥çœ‹å‡ºå…©çµ„ä¹‹é–“æœ‰æ²’æœ‰çµ±è¨ˆé¡¯è‘—å·®ç•°ã€‚

### åŠ å…¥ p-value

```{r}
#| label: table1-pvalue
#| echo: true
#| message: false
#| warning: false

# å»ºç«‹å« p-value çš„ Table 1
table1_with_p <- my_data %>%
  select(treatment, age, gender, los) %>%
  tbl_summary(
    by = treatment,
    statistic = list(
      all_continuous() ~ "{mean} ({sd})",
      all_categorical() ~ "{n} ({p}%)"
    )
  ) %>%
  add_p()

table1_with_p
```

## ä»»å‹™ 12ï¼šçœ‹æ‡‚ gtsummary çš„é¸æ“‡

ğŸ“‹ **è¤‡è£½é€™æ®µè©±ï¼Œè²¼çµ¦ AIï¼š**

> gtsummary åœ¨è¨ˆç®— p-value çš„æ™‚å€™ï¼Œæ˜¯æ€éº¼æ±ºå®šè¦ç”¨ä»€éº¼çµ±è¨ˆæ–¹æ³•çš„ï¼Ÿä¾‹å¦‚ï¼Œä»€éº¼æ™‚å€™ç”¨ t-testã€ä»€éº¼æ™‚å€™ç”¨ Wilcoxonã€ä»€éº¼æ™‚å€™ç”¨å¡æ–¹æª¢å®šï¼Ÿ

### gtsummary çš„çµ±è¨ˆæ–¹æ³•é¸æ“‡

gtsummary æœƒæ ¹æ“šè³‡æ–™é¡å‹è‡ªå‹•é¸æ“‡é©ç•¶çš„çµ±è¨ˆæª¢å®šï¼š

- **é€£çºŒè®Šæ•¸**ï¼šé è¨­ä½¿ç”¨ Wilcoxon rank-sum testï¼ˆç„¡æ¯æ•¸æª¢å®šï¼‰
- **é¡åˆ¥è®Šæ•¸**ï¼šä½¿ç”¨ Chi-square testï¼ˆå¡æ–¹æª¢å®šï¼‰æˆ– Fisher's exact testï¼ˆç•¶æ¨£æœ¬æ•¸å°æ™‚ï¼‰

ä½ å¯ä»¥è‡ªè¨‚çµ±è¨ˆæ–¹æ³•ï¼š

```{r}
#| label: custom-tests
#| echo: true
#| message: false
#| warning: false

# è‡ªè¨‚çµ±è¨ˆæª¢å®šæ–¹æ³•
table1_custom <- my_data %>%
  select(treatment, age, gender, los) %>%
  tbl_summary(
    by = treatment,
    statistic = list(
      all_continuous() ~ "{mean} ({sd})",
      all_categorical() ~ "{n} ({p}%)"
    )
  ) %>%
  add_p(
    test = list(
      age ~ "t.test",        # ä½¿ç”¨ t-test
      los ~ "wilcox.test",   # ä½¿ç”¨ Wilcoxon test
      gender ~ "chisq.test"  # ä½¿ç”¨å¡æ–¹æª¢å®š
    )
  )

table1_custom
```

## ä»»å‹™ 13ï¼šå®¢è£½åŒ–ä½ çš„è¡¨æ ¼

ğŸ“‹ **è¤‡è£½é€™æ®µè©±ï¼Œè²¼çµ¦ AIï¼š**

> æˆ‘æƒ³è¦ä¿®æ”¹æˆ‘çš„ gtsummary è¡¨æ ¼ï¼š
> 
> 1. é€£çºŒè®Šæ•¸é¡¯ç¤ºã€Œå¹³å‡å€¼ Â± æ¨™æº–å·®ã€è€Œä¸æ˜¯ä¸­ä½æ•¸
> 2. æŠŠæ¬„ä½åç¨±æ”¹æˆä¸­æ–‡ï¼ˆage â†’ å¹´é½¡ã€gender â†’ æ€§åˆ¥ã€los â†’ ä½é™¢å¤©æ•¸ï¼‰
> 3. p-value å¦‚æœå°æ–¼ 0.05 å°±ç”¨ç²—é«”æ¨™ç¤º

### å®¢è£½åŒ–è¡¨æ ¼

```{r}
#| label: table1-custom
#| echo: true
#| message: false
#| warning: false

# å®¢è£½åŒ– Table 1
table1_final <- my_data %>%
  select(treatment, age, gender, los) %>%
  tbl_summary(
    by = treatment,
    label = list(
      age ~ "å¹´é½¡",
      gender ~ "æ€§åˆ¥",
      los ~ "ä½é™¢å¤©æ•¸"
    ),
    statistic = list(
      all_continuous() ~ "{mean} Â± {sd}",
      all_categorical() ~ "{n} ({p}%)"
    )
  ) %>%
  add_p() %>%
  bold_p(t = 0.05) %>%
  modify_header(label ~ "**è®Šé …**") %>%
  modify_spanning_header(c("stat_1", "stat_2") ~ "**æ²»ç™‚çµ„åˆ¥**")

table1_final
```

## ä»»å‹™ 14ï¼šåŒ¯å‡ºä½ çš„è¡¨æ ¼

ğŸ“‹ **è¤‡è£½é€™æ®µè©±ï¼Œè²¼çµ¦ AIï¼š**

> æˆ‘åšå¥½äº†ä¸€å€‹ gtsummary çš„è¡¨æ ¼ï¼Œå­˜åœ¨è®Šæ•¸ `my_table` è£¡é¢ã€‚æˆ‘æƒ³è¦æŠŠå®ƒè¼¸å‡ºæˆ Word æª”æ¡ˆï¼Œæ–¹ä¾¿è²¼åˆ°æˆ‘çš„è«–æ–‡ã€‚è«‹çµ¦æˆ‘ç¨‹å¼ç¢¼ã€‚

### åŒ¯å‡ºè¡¨æ ¼

```{r}
#| label: export-table
#| echo: true
#| eval: false

# å®‰è£å¿…è¦å¥—ä»¶ï¼ˆå¦‚æœé‚„æ²’å®‰è£ï¼‰
# install.packages("flextable")

library(flextable)

# è½‰æ›ç‚º flextable æ ¼å¼ä¸¦å­˜æˆ Word æª”
table1_final %>%
  as_flex_table() %>%
  flextable::save_as_docx(path = "Table1.docx")

print("Table 1 å·²æˆåŠŸåŒ¯å‡ºç‚º Table1.docx")
```